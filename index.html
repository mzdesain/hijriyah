<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Islamic Hub | Muzanni</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Noto+Sans+Arabic:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #ffffff; color: #1e293b; }
        .arabic-num { font-family: 'Noto Sans Arabic', serif; }
        .calendar-grid {
            display: grid; grid-template-columns: repeat(7, 1fr);
            gap: 1px; background-color: #f1f5f9;
            border-radius: 20px; overflow: hidden; border: 1px solid #f1f5f9;
        }
        .calendar-day {
            background-color: #ffffff; aspect-ratio: 1/1.3;
            padding: 6px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; transition: all 0.3s ease;
        }
        /* Warna Latar Belakang Tabel Sesuai Perintah Muzanni */
        .bg-ayyamul-bidh { background-color: #ecfdf5 !important; } /* Hijau */
        .bg-senin-kamis { background-color: #fff7ed !important; }  /* Orange */
        .bg-hari-raya { background-color: #eff6ff !important; }    /* Biru */
        .bg-arafah { background-color: #f5f3ff !important; }       /* Ungu */
        
        .today { border: 2px solid #0f172a; border-radius: 12px; z-index: 10; }
        .day-name { text-align: center; font-size: 0.65rem; font-weight: 800; color: #cbd5e1; padding: 12px 0; text-transform: uppercase; letter-spacing: 0.1em; }
    </style>
</head>
<body class="antialiased pb-10">

    <div class="max-w-xl mx-auto px-6 py-8">
        <header class="mb-10 text-center">
            <div onclick="init()" class="cursor-pointer inline-flex items-center gap-2 px-3 py-1 bg-emerald-50 text-emerald-600 text-[10px] font-black rounded-full uppercase tracking-widest mb-4 hover:bg-emerald-100 transition-all">
                <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/><path d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
                <span id="subdistrict-name">Cek Lokasi...</span>
            </div>
            
            <div id="digital-clock" class="text-2xl font-bold text-emerald-600 mb-2 tracking-widest">00:00:00</div>
            
            <h1 id="top-hijri" class="text-4xl font-extrabold text-slate-900 tracking-tighter mb-1 arabic-num">---</h1>
            <p id="top-masehi" class="text-[10px] font-bold text-slate-400 tracking-[0.2em] uppercase"></p>
        </header>

        <section class="grid grid-cols-5 gap-2 mb-10">
            <div class="bg-slate-50 p-3 rounded-2xl text-center border border-slate-100 text-emerald-700">
                <p class="text-[8px] font-black text-slate-300 uppercase mb-1">Subuh</p>
                <p id="fajr" class="text-xs font-bold italic">--:--</p>
            </div>
            <div class="bg-slate-50 p-3 rounded-2xl text-center border border-slate-100 text-emerald-700">
                <p class="text-[8px] font-black text-slate-300 uppercase mb-1">Dzuhur</p>
                <p id="dhuhr" class="text-xs font-bold italic">--:--</p>
            </div>
            <div class="bg-slate-50 p-3 rounded-2xl text-center border border-slate-100 text-emerald-700">
                <p class="text-[8px] font-black text-slate-300 uppercase mb-1">Ashar</p>
                <p id="asr" class="text-xs font-bold italic">--:--</p>
            </div>
            <div class="bg-slate-50 p-3 rounded-2xl text-center border border-slate-100 text-emerald-700">
                <p class="text-[8px] font-black text-slate-300 uppercase mb-1">Maghrib</p>
                <p id="maghrib" class="text-xs font-bold italic">--:--</p>
            </div>
            <div class="bg-slate-50 p-3 rounded-2xl text-center border border-slate-100 text-emerald-700">
                <p class="text-[8px] font-black text-slate-300 uppercase mb-1">Isya</p>
                <p id="isha" class="text-xs font-bold italic">--:--</p>
            </div>
        </section>

        <section>
            <div class="mb-4 px-2">
                <div class="flex items-center justify-between">
                    <h3 id="calendar-label" class="font-extrabold text-xs sm:text-base text-slate-800 tracking-tight">---</h3>
                    <div class="flex gap-1">
                        <button onclick="changeMonth(-1)" class="p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-400">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M15 19l-7-7 7-7"/></svg>
                        </button>
                        <button onclick="changeMonth(1)" class="p-2 hover:bg-slate-100 rounded-full transition-colors text-slate-400">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M9 5l7 7-7 7"/></svg>
                        </button>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-7 mb-1 text-center font-bold text-slate-300 text-[10px] uppercase tracking-widest">
                <div>Min</div><div>Sen</div><div>Sel</div><div>Rab</div><div>Kam</div><div>Jum</div><div>Sab</div>
            </div>
            <div id="calendar-body" class="calendar-grid"></div>

            <div class="mt-8 grid grid-cols-2 gap-3 px-2">
                <div class="flex items-center gap-2 text-[9px] font-bold text-slate-500 uppercase tracking-wider">
                    <div class="w-2 h-2 rounded-full bg-emerald-400"></div> Ayyamul Bidh
                </div>
                <div class="flex items-center gap-2 text-[9px] font-bold text-slate-500 uppercase tracking-wider">
                    <div class="w-2 h-2 rounded-full bg-orange-400"></div> Senin & Kamis
                </div>
                <div class="flex items-center gap-2 text-[9px] font-bold text-slate-500 uppercase tracking-wider">
                    <div class="w-2 h-2 rounded-full bg-blue-400"></div> Idul Fitri / Adha
                </div>
                <div class="flex items-center gap-2 text-[9px] font-bold text-slate-500 uppercase tracking-wider">
                    <div class="w-2 h-2 rounded-full bg-purple-400"></div> Puasa Arafah
                </div>
            </div>
        </section>

        <section id="islamic-quote-box" class="mt-10 p-5 bg-slate-50 rounded-2xl border border-slate-100 text-center transition-all duration-500">
            <p id="quote-text" class="text-sm italic text-slate-600 leading-relaxed">"Memuat nasihat..."</p>
            <p id="quote-ref" class="text-[10px] font-bold text-emerald-600 uppercase mt-3 tracking-widest"></p>
        </section>

        <footer class="mt-16 text-center border-t border-slate-50 pt-8">
            <p class="text-[9px] font-black text-slate-300 uppercase tracking-[0.3em]">
                &copy; <span id="year"></span> • BY MUZANNI
            </p>
        </footer>
    </div>

    <script>
        let viewDate = new Date();
        const arabicDigits = ['٠', '١', '٢', '٣', '٤', '٥', '٦', '٧', '٨', '٩'];
        const toAr = (n) => n.toString().split('').map(d => arabicDigits[d] || d).join('');

        const hijriQuotes = {
            1: { text: "Puasa yang paling utama setelah Ramadhan adalah puasa pada bulan Allah (yaitu) Muharram.", ref: "HR. Muslim" },
            2: { text: "Tidak ada wabah dan tidak ada kesialan pada bulan Safar.", ref: "HR. Bukhari" },
            3: { text: "Sesungguhnya telah ada pada (diri) Rasulullah itu suri teladan yang baik bagimu.", ref: "QS. Al-Ahzab: 21" },
            4: { text: "Sebaik-baik manusia adalah yang paling bermanfaat bagi manusia lainnya.", ref: "HR. Ahmad" },
            5: { text: "Barangsiapa menempuh jalan untuk mencari ilmu, Allah mudahkan baginya jalan menuju surga.", ref: "HR. Muslim" },
            6: { text: "Dunia adalah perhiasan, dan sebaik-baik perhiasan adalah istri yang shalihah.", ref: "HR. Muslim" },
            7: { text: "Lakukanlah kebajikan sebanyak-banyaknya di bulan-bulan haram (Rajab).", ref: "Nasihat Ulama" },
            8: { text: "Bulan Sya'ban adalah bulan diangkatnya amal-amal kepada Rabb semesta alam.", ref: "HR. An-Nasa'i" },
            9: { text: "Bulan Ramadhan, bulan yang di dalamnya diturunkan Al-Qur'an.", ref: "QS. Al-Baqarah: 185" },
            10: { text: "Puasa Ramadhan kemudian diiringi puasa enam hari di bulan Syawwal seolah berpuasa setahun penuh.", ref: "HR. Muslim" },
            11: { text: "Dzulqa'dah adalah salah satu dari empat bulan haram. Jagalah diri dari kemaksiatan.", ref: "Tafsir Ibnu Katsir" },
            12: { text: "Tidak ada hari di mana amal shalih lebih dicintai Allah melebihi sepuluh hari pertama Dzulhijjah.", ref: "HR. Bukhari" }
        };

        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('id-ID', { hour12: false });
            document.getElementById('digital-clock').innerText = timeStr.replace(/\./g, ':');
        }
        setInterval(updateClock, 1000);
        updateClock();

        async function init() {
            document.getElementById('year').innerText = new Date().getFullYear();
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(async p => {
                    await updateData(p.coords.latitude, p.coords.longitude);
                }, () => updateData(-6.2088, 106.8456), { enableHighAccuracy: true });
            } else { updateData(-6.2088, 106.8456); }
        }

        async function updateData(lat, lng) {
            try {
                const locRes = await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${lat}&lon=${lng}&zoom=18`);
                const locData = await locRes.json();
                const subdistrict = locData.address.village || locData.address.suburb || locData.address.town || "Lokasi Anda";
                document.getElementById('subdistrict-name').innerText = subdistrict.toUpperCase();

                const month = viewDate.getMonth() + 1;
                const year = viewDate.getFullYear();
                const res = await fetch(`https://api.aladhan.com/v1/calendar?latitude=${lat}&longitude=${lng}&method=11&month=${month}&year=${year}`);
                const json = await res.json();
                
                const today = new Date().getDate();
                const d = json.data[today - 1] || json.data[0];
                const h = d.date.hijri;
                document.getElementById('top-hijri').innerText = `${toAr(h.day)} ${h.month.en} ${toAr(h.year)}`;
                document.getElementById('top-masehi').innerText = d.date.gregorian.date.toUpperCase();
                
                ['Fajr', 'Dhuhr', 'Asr', 'Maghrib', 'Isha'].forEach(k => {
                    document.getElementById(k.toLowerCase()).innerText = d.timings[k].split(' ')[0];
                });

                updateCalendarLabel(json.data);
                renderCalendar(viewDate, json.data);
                setIslamicQuote(parseInt(h.month.number));
            } catch (e) { console.error(e); }
        }

        function setIslamicQuote(monthNumber) {
            const quote = hijriQuotes[monthNumber] || hijriQuotes[1];
            const box = document.getElementById('islamic-quote-box');
            box.style.opacity = 0;
            setTimeout(() => {
                document.getElementById('quote-text').innerText = `"${quote.text}"`;
                document.getElementById('quote-ref').innerText = quote.ref;
                box.style.opacity = 1;
            }, 300);
        }

        function updateCalendarLabel(calendarData) {
            const masehiMonth = ["Januari", "Februari", "Maret", "April", "Mei", "Juni", "Juli", "Agustus", "September", "Oktober", "November", "Desember"][viewDate.getMonth()];
            const startH = calendarData[0].date.hijri.month.en;
            const endH = calendarData[calendarData.length - 1].date.hijri.month.en;
            const hYear = calendarData[0].date.hijri.year;
            let label = startH === endH ? startH : `${startH} - ${endH}`;
            document.getElementById('calendar-label').innerHTML = `${masehiMonth} ${viewDate.getFullYear()} <span class="text-slate-200 mx-2">|</span> <span class="text-emerald-600">${label} ${hYear} H</span>`;
        }

        function renderCalendar(date, calendarData) {
            const body = document.getElementById('calendar-body');
            const firstIdx = new Date(date.getFullYear(), date.getMonth(), 1).getDay();
            const today = new Date();
            body.innerHTML = '';
            for (let i = 0; i < firstIdx; i++) body.innerHTML += `<div class="calendar-day bg-slate-50/50"></div>`;

            calendarData.forEach((dayData, index) => {
                const d = index + 1;
                const hD = parseInt(dayData.date.hijri.day);
                const hM = parseInt(dayData.date.hijri.month.number);
                const dw = parseInt(dayData.date.gregorian.weekday.number); 
                
                let bg = "";
                let txt = "text-slate-400";

                if ([13, 14, 15].includes(hD)) { bg = "bg-ayyamul-bidh"; txt = "text-emerald-600 font-bold"; }
                else if (dw === 1 || dw === 4) { bg = "bg-senin-kamis"; txt = "text-orange-600 font-bold"; }
                
                if ((hM === 10 && hD === 1) || (hM === 12 && hD === 10)) { bg = "bg-hari-raya"; txt = "text-blue-600 font-bold"; }
                if (hM === 12 && hD === 9) { bg = "bg-arafah"; txt = "text-purple-600 font-bold"; }

                const isToday = (d === today.getDate() && date.getMonth() === today.getMonth() && date.getFullYear() === today.getFullYear()) ? 'today' : '';
                body.innerHTML += `<div class="calendar-day ${isToday} ${bg}"><span class="masehi-num text-xs font-semibold mb-1">${d}</span><span class="text-[10px] arabic-num ${txt}">${toAr(hD)}</span></div>`;
            });
        }

        function changeMonth(step) { viewDate.setMonth(viewDate.getMonth() + step); init(); }

        init();
    </script>
</body>
</html>
